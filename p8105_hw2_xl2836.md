Homework\_2
================
Xinyi Lin
9/28/2018

Problem 1
=========

Read and clean data
-------------------

Before dealing with data, we need to load related packages and import data.

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
    ## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
    ## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
    ## ✔ readr   1.1.1     ✔ forcats 0.3.0

    ## ── Conflicts ────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
NYC_subway_data = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")

NYC_subway_data = janitor::clean_names(NYC_subway_data)

head(NYC_subway_data)
```

    ## # A tibble: 6 x 32
    ##   division line  station_name station_latitude station_longitu… route1
    ##   <chr>    <chr> <chr>                   <dbl>            <dbl> <chr> 
    ## 1 BMT      4 Av… 25th St                  40.7            -74.0 R     
    ## 2 BMT      4 Av… 25th St                  40.7            -74.0 R     
    ## 3 BMT      4 Av… 36th St                  40.7            -74.0 N     
    ## 4 BMT      4 Av… 36th St                  40.7            -74.0 N     
    ## 5 BMT      4 Av… 36th St                  40.7            -74.0 N     
    ## 6 BMT      4 Av… 45th St                  40.6            -74.0 R     
    ## # ... with 26 more variables: route2 <chr>, route3 <chr>, route4 <chr>,
    ## #   route5 <chr>, route6 <chr>, route7 <chr>, route8 <int>, route9 <int>,
    ## #   route10 <int>, route11 <int>, entrance_type <chr>, entry <chr>,
    ## #   exit_only <chr>, vending <chr>, staffing <chr>, staff_hours <chr>,
    ## #   ada <lgl>, ada_notes <chr>, free_crossover <lgl>,
    ## #   north_south_street <chr>, east_west_street <chr>, corner <chr>,
    ## #   entrance_latitude <dbl>, entrance_longitude <dbl>,
    ## #   station_location <chr>, entrance_location <chr>

Then, we try to select the variables we interested and change the structure of the dataset do that it is easier to analyze.

``` r
NYC_subway_clean_data =
  gather(NYC_subway_data, key = route_number, value = route_name, route1:route11) %>% 
  separate(route_number, into = c("remove", "route_number"), sep = 5) %>%
  select(line, station_name, station_latitude, station_longitude, route_number, route_name, entry, entrance_type, vending, ada, ada_notes) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))

head(NYC_subway_clean_data)
```

    ## # A tibble: 6 x 11
    ##   line  station_name station_latitude station_longitu… route_number
    ##   <chr> <chr>                   <dbl>            <dbl> <chr>       
    ## 1 4 Av… 25th St                  40.7            -74.0 1           
    ## 2 4 Av… 25th St                  40.7            -74.0 1           
    ## 3 4 Av… 36th St                  40.7            -74.0 1           
    ## 4 4 Av… 36th St                  40.7            -74.0 1           
    ## 5 4 Av… 36th St                  40.7            -74.0 1           
    ## 6 4 Av… 45th St                  40.6            -74.0 1           
    ## # ... with 6 more variables: route_name <chr>, entry <lgl>,
    ## #   entrance_type <chr>, vending <chr>, ada <lgl>, ada_notes <chr>

In the original dataset, there are 1868 observations and 32 variables. The variables including division and line of subway, name, latitude and longitude of stations, routes served, staff information and related information about entrance ane exit.

As "route 1" to "route 11" are same kind of variables, we can combine them to turm them and their values into new variables "route\_number" and "route\_name". Besides, we only interested in information about station, routes, entrance and exit, we chose parts of variables for further analysis, including line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. We also convert the entry variable from character (YES vs NO) to a logical variable (the ifelse or recode function may be useful).

Now the new dataset have 20548 observations and 11 variables and it is tidier.

Answering questions
-------------------

1.  There are 465 distinct stations which have different station names or lines in the dataset.

2.  We define that only those stations which ADA is available are ADA compliant, so those stations with ADA notes like "Check" or "Shuttle not ADA" are not regarded as ADA compliant. There are 4565 stations are ADA compliant.

3.  As the observation in this dataset have either different entrance loation or different entrance type, we define each observation in this dataset as distinct entrance/exit, so the total number of entrances/exits is 1868 and the number of entrances/exits without vending is 183. The proportion of entrances/exits without vending is 0.0979657.

``` r
atrain_stations =
  filter(NYC_subway_clean_data, route_name == "A") %>% 
  distinct(line, station_name) %>% 
  nrow()
```

``` r
ada_atrain_stations =
  filter(NYC_subway_clean_data, route_name == "A", ada == "TRUE", is.na(ada_notes)) %>% 
  distinct(line, station_name) %>% 
  nrow()
```

1.  There are 60 distinct stations serve the A train and 15 of them are ADA compliant.

Problem 2
=========

The Mr. Trash Wheel sheet
-------------------------

Read and clean data.

``` r
library(readxl)
MrTW_data = 
  read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx") %>% 
  janitor::clean_names() 

head(MrTW_data)
```

    ## # A tibble: 6 x 15
    ##   dumpster month  year date                weight_tons volume_cubic_ya…
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## 6        6 May    2014 2014-05-20 00:00:00        2.71               13
    ## # ... with 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, grocery_bags <dbl>,
    ## #   chip_bags <dbl>, sports_balls <dbl>, homes_powered <dbl>, x_1 <chr>

``` r
MrTW_clean_data = 
  select(MrTW_data, -x_1) %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = as.integer(round(sports_balls)))

head(MrTW_clean_data)
```

    ## # A tibble: 6 x 14
    ##   dumpster month  year date                weight_tons volume_cubic_ya…
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## 6        6 May    2014 2014-05-20 00:00:00        2.71               13
    ## # ... with 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, grocery_bags <dbl>,
    ## #   chip_bags <dbl>, sports_balls <int>, homes_powered <dbl>

The 2016/2017 precipitation sheet
---------------------------------

Read and clean data.

``` r
precipitation_2016_data = 
  read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                                     sheet = "2016 Precipitation", skip = 1) %>% 
  janitor::clean_names() 

precipitation_2017_data = 
  read_excel(path = "./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                                     sheet = "2017 Precipitation", skip = 1) %>% 
  janitor::clean_names() 

precip_2016_clean_data = filter(precipitation_2016_data, !is.na(month), !is.na(total)) %>% 
  mutate(year = 2016) %>% 
  select(year, month, total)

head(precip_2016_clean_data)
```

    ## # A tibble: 6 x 3
    ##    year month total
    ##   <dbl> <dbl> <dbl>
    ## 1  2016     1  3.23
    ## 2  2016     2  5.32
    ## 3  2016     3  2.24
    ## 4  2016     4  1.78
    ## 5  2016     5  5.19
    ## 6  2016     6  3.2

``` r
precip_2017_clean_data = filter(precipitation_2017_data, !is.na(month), !is.na(total)) %>% 
  mutate(year = 2017) %>% 
  select(year, month, total)

head(precip_2017_clean_data)
```

    ## # A tibble: 6 x 3
    ##    year month total
    ##   <dbl> <dbl> <dbl>
    ## 1  2017     1  2.34
    ## 2  2017     2  1.46
    ## 3  2017     3  3.57
    ## 4  2017     4  3.99
    ## 5  2017     5  5.64
    ## 6  2017     6  1.4

Combine datasets and convert month to a character variable.

``` r
precipitation_clean_data = 
  bind_rows(precip_2016_clean_data, precip_2017_clean_data) %>% 
  mutate(month = month.abb[month])

head(precipitation_clean_data)
```

    ## # A tibble: 6 x 3
    ##    year month total
    ##   <dbl> <chr> <dbl>
    ## 1  2016 Jan    3.23
    ## 2  2016 Feb    5.32
    ## 3  2016 Mar    2.24
    ## 4  2016 Apr    1.78
    ## 5  2016 May    5.19
    ## 6  2016 Jun    3.2

Overall
-------

``` r
MrTW_2016_clean_data = filter(MrTW_clean_data, year == "2016") 
sports_balls_median = median(MrTW_2016_clean_data$sports_balls)
```

There are 216 observations and 14 variables in the `MrTW_clean_data` dataset. The key variables including `dumpster`, `data` and `homes_powered`. There are 20 observations and 3 variables in the `precipitation_clean_data` dataset. The key variables are `year`, `month` and `total`. Among them, 12 observations are from 2016, and 8 observations are from 2017.The total precipitation in 2017 is 29.93. The median number of sports balls in a dumpster in 2016 is 26.
